/*
 RequireJS 2.0.6 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/jrburke/requirejs for details
*/

/**
 * marked - A markdown parser (https://github.com/chjj/marked)
 * Copyright (c) 2011-2012, Christopher Jeffrey. (MIT Licensed)
 */

var requirejs,require,define;(function(Z){function x(e){return J.call(e)==="[object Function]"}function E(e){return J.call(e)==="[object Array]"}function o(e,t){if(e){var n;for(n=0;n<e.length;n+=1)if(e[n]&&t(e[n],n,e))break}}function M(e,t){if(e){var n;for(n=e.length-1;n>-1;n-=1)if(e[n]&&t(e[n],n,e))break}}function y(e,t){for(var n in e)if(e.hasOwnProperty(n)&&t(e[n],n))break}function N(e,t,n,r){return t&&y(t,function(t,i){if(n||!F.call(e,i))r&&typeof t!="string"?(e[i]||(e[i]={}),N(e[i],t,n,r)):e[i]=t}),e}function t(e,t){return function(){return t.apply(e,arguments)}}function $(e){if(!e)return e;var t=Z;return o(e.split("."),function(e){t=t[e]}),t}function aa(e,t,n){return function(){var r=ga.call(arguments,0),i;return n&&x(i=r[r.length-1])&&(i.__requireJsBuild=!0),r.push(t),e.apply(null,r)}}function ba(e,t,n){o([["toUrl"],["undef"],["defined","requireDefined"],["specified","requireSpecified"]],function(r){var i=r[1]||r[0];e[r[0]]=t?aa(t[i],n):function(){var e=z[O];return e[i].apply(e,arguments)}})}function G(e,t,n,r){return t=Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e),t.requireType=e,t.requireModules=r,n&&(t.originalError=n),t}function ha(){return H&&H.readyState==="interactive"?H:(M(document.getElementsByTagName("script"),function(e){if(e.readyState==="interactive")return H=e}),H)}var j,p,u,B,s,C,H,I,ca,da,ia=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,ja=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,ea=/\.js$/,ka=/^\.\//;p=Object.prototype;var J=p.toString,F=p.hasOwnProperty;p=Array.prototype;var ga=p.slice,la=p.splice,w=typeof window!="undefined"&&!!navigator&&!!document,fa=!w&&typeof importScripts!="undefined",ma=w&&navigator.platform==="PLAYSTATION 3"?/^complete$/:/^(complete|loaded)$/,O="_",S=typeof opera!="undefined"&&opera.toString()==="[object Opera]",z={},r={},P=[],K=!1;if(typeof define=="undefined"){if(typeof requirejs!="undefined"){if(x(requirejs))return;r=requirejs,requirejs=void 0}typeof require!="undefined"&&!x(require)&&(r=require,require=void 0),j=requirejs=function(e,t,n,r){var i,s=O;return!E(e)&&typeof e!="string"&&(i=e,E(t)?(e=t,t=n,n=r):e=[]),i&&i.context&&(s=i.context),(r=z[s])||(r=z[s]=j.s.newContext(s)),i&&r.configure(i),r.require(e,t,n)},j.config=function(e){return j(e)},require||(require=j),j.version="2.0.6",j.jsExtRegExp=/^\/|:|\?|\.js$/,j.isBrowser=w,p=j.s={contexts:z,newContext:function(e){function n(e,t,n){var r,i,s,o,u,a,f,l=t&&t.split("/");r=l;var c=O.map,h=c&&c["*"];if(e&&e.charAt(0)===".")if(t){r=O.pkgs[t]?l=[t]:l.slice(0,l.length-1),t=e=r.concat(e.split("/"));for(r=0;t[r];r+=1)if(i=t[r],i===".")t.splice(r,1),r-=1;else if(i===".."){if(r===1&&(t[2]===".."||t[0]===".."))break;r>0&&(t.splice(r-1,2),r-=2)}r=O.pkgs[t=e[0]],e=e.join("/"),r&&e===t+"/"+r.main&&(e=t)}else e.indexOf("./")===0&&(e=e.substring(2));if(n&&(l||h)&&c){t=e.split("/");for(r=t.length;r>0;r-=1){s=t.slice(0,r).join("/");if(l)for(i=l.length;i>0;i-=1)if(n=c[l.slice(0,i).join("/")])if(n=n[s]){o=n,u=r;break}if(o)break;!a&&h&&h[s]&&(a=h[s],f=r)}!o&&a&&(o=a,u=f),o&&(t.splice(0,u,o),e=t.join("/"))}return e}function r(e){w&&o(document.getElementsByTagName("script"),function(t){if(t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===k.contextName)return t.parentNode.removeChild(t),!0})}function i(e){var t=O.paths[e];if(t&&E(t)&&t.length>1)return r(e),t.shift(),k.undef(e),k.require([e]),!0}function s(e,t,r,i){var s,o,u=e?e.indexOf("!"):-1,a=null,f=t?t.name:null,l=e,c=!0,h="";return e||(c=!1,e="_@r"+(q+=1)),u!==-1&&(a=e.substring(0,u),e=e.substring(u+1,e.length)),a&&(a=n(a,f,i),o=B[a]),e&&(a?h=o&&o.normalize?o.normalize(e,function(e){return n(e,f,i)}):n(e,f,i):(h=n(e,f,i),s=k.nameToUrl(h))),e=a&&!o&&!r?"_unnormalized"+(R+=1):"",{prefix:a,name:h,parentMap:t,unnormalized:!!e,url:s,originalName:l,isDefine:c,id:(a?a+"!"+h:h)+e}}function u(e){var t=e.id,n=M[t];return n||(n=M[t]=new k.Module(e)),n}function a(e,t,n){var r=e.id,i=M[r];F.call(B,r)&&(!i||i.defineEmitComplete)?t==="defined"&&n(B[r]):u(e).on(t,n)}function f(e,t){var n=e.requireModules,r=!1;t?t(e):(o(n,function(t){if(t=M[t])t.error=e,t.events.error&&(r=!0,t.emit("error",e))}),!r)&&j.onError(e)}function l(){P.length&&(la.apply(D,[D.length-1,0].concat(P)),P=[])}function c(e,t,n){return e=e&&e.map,t=aa(n||k.require,e,t),ba(t,k,e),t.isBrowser=w,t}function h(e){delete M[e],o(U,function(t,n){if(t.map.id===e)return U.splice(n,1),t.defined||(k.waitCount-=1),!0})}function p(e,t,n){var r=e.map.id,i=e.depMaps,s;if(e.inited)return t[r]?e:(t[r]=!0,o(i,function(e){var e=e.id,r=M[e];return!r||n[e]||!r.inited||!r.enabled?void 0:s=p(r,t,n)}),n[r]=!0,s)}function d(e,t,n){var r=e.map.id,i=e.depMaps;if(e.inited&&e.map.isDefine)return t[r]?B[r]:(t[r]=e,o(i,function(i){var i=i.id,s=M[i];!L[i]&&s&&(!s.inited||!s.enabled?n[r]=!0:(s=d(s,t,n),n[i]||e.defineDepById(i,s)))}),e.check(!0),B[r])}function v(e){e.check()}function m(){var e,t,n,s,u=(n=O.waitSeconds*1e3)&&k.startTime+n<(new Date).getTime(),a=[],l=!1,c=!0;if(!T){T=!0,y(M,function(n){e=n.map,t=e.id;if(n.enabled&&!n.error)if(!n.inited&&u)i(t)?l=s=!0:(a.push(t),r(t));else if(!n.inited&&n.fetched&&e.isDefine&&(l=!0,!e.prefix))return c=!1});if(u&&a.length)return n=G("timeout","Load timeout for modules: "+a,null,a),n.contextName=k.contextName,f(n);c&&(o(U,function(e){if(!e.defined){var e=p(e,{},{}),t={};e&&(d(e,t,{}),y(t,v))}}),y(M,v)),(!u||s)&&l&&(w||fa)&&!A&&(A=setTimeout(function(){A=0,m()},50)),T=!1}}function g(e){u(s(e[0],null,!0)).init(e[1],e[2])}function b(e){var e=e.currentTarget||e.srcElement,t=k.onScriptLoad;return e.detachEvent&&!S?e.detachEvent("onreadystatechange",t):e.removeEventListener("load",t,!1),t=k.onScriptError,e.detachEvent&&!S||e.removeEventListener("error",t,!1),{node:e,id:e&&e.getAttribute("data-requiremodule")}}var T,C,k,L,A,O={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{}},M={},_={},D=[],B={},I={},q=1,R=1,U=[];return L={require:function(e){return c(e)},exports:function(e){e.usingExports=!0;if(e.map.isDefine)return e.exports=B[e.map.id]={}},module:function(e){return e.module={id:e.map.id,uri:e.map.url,config:function(){return O.config&&O.config[e.map.id]||{}},exports:B[e.map.id]}}},C=function(e){this.events=_[e.id]||{},this.map=e,this.shim=O.shim[e.id],this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},C.prototype={init:function(e,n,r,i){i=i||{},this.inited||(this.factory=n,r?this.on("error",r):this.events.error&&(r=t(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.depMaps.rjsSkipMap=e.rjsSkipMap,this.errback=r,this.inited=!0,this.ignore=i.ignore,i.enabled||this.enabled?this.enable():this.check())},defineDepById:function(e,t){var n;return o(this.depMaps,function(t,r){if(t.id===e)return n=r,!0}),this.defineDep(n,t)},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,k.startTime=(new Date).getTime();var e=this.map;if(!this.shim)return e.prefix?this.callPlugin():this.load();c(this,!0)(this.shim.deps||[],t(this,function(){return e.prefix?this.callPlugin():this.load()}))}},load:function(){var e=this.map.url;I[e]||(I[e]=!0,k.load(this.map.id,e))},check:function(e){if(this.enabled&&!this.enabling){var t,n,r=this.map.id;n=this.depExports;var i=this.exports,s=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){this.defining=!0;if(this.depCount<1&&!this.defined){if(x(s)){if(this.events.error)try{i=k.execCb(r,s,n,i)}catch(o){t=o}else i=k.execCb(r,s,n,i);this.map.isDefine&&((n=this.module)&&n.exports!==void 0&&n.exports!==this.exports?i=n.exports:i===void 0&&this.usingExports&&(i=this.exports));if(t)return t.requireMap=this.map,t.requireModules=[this.map.id],t.requireType="define",f(this.error=t)}else i=s;this.exports=i,this.map.isDefine&&!this.ignore&&(B[r]=i,j.onResourceLoad)&&j.onResourceLoad(k,this.map,this.depMaps),delete M[r],this.defined=!0,k.waitCount-=1,k.waitCount===0&&(U=[])}this.defining=!1,!e&&this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var e=this.map,r=e.id,i=s(e.prefix,null,!1,!0);a(i,"defined",t(this,function(i){var o;o=this.map.name;var l=this.map.parentMap?this.map.parentMap.name:null;if(this.map.unnormalized){if(i.normalize&&(o=i.normalize(o,function(e){return n(e,l,!0)})||""),i=s(e.prefix+"!"+o,this.map.parentMap,!1,!0),a(i,"defined",t(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),i=M[i.id])this.events.error&&i.on("error",t(this,function(e){this.emit("error",e)})),i.enable()}else o=t(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),o.error=t(this,function(e){this.inited=!0,this.error=e,e.requireModules=[r],y(M,function(e){e.map.id.indexOf(r+"_unnormalized")===0&&h(e.map.id)}),f(e)}),o.fromText=function(e,t){var n=K;n&&(K=!1),u(s(e)),j.exec(t),n&&(K=!0),k.completeLoad(e)},i.load(e.name,c(e.parentMap,!0,function(e,t,n){return e.rjsSkipMap=!0,k.require(e,t,n)}),o,O)})),k.enable(i,this),this.pluginMaps[i.id]=i},enable:function(){this.enabled=!0,this.waitPushed||(U.push(this),k.waitCount+=1,this.waitPushed=!0),this.enabling=!0,o(this.depMaps,t(this,function(e,n){var r,i;if(typeof e=="string"){e=s(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.depMaps.rjsSkipMap),this.depMaps[n]=e;if(r=L[e.id]){this.depExports[n]=r(this);return}this.depCount+=1,a(e,"defined",t(this,function(e){this.defineDep(n,e),this.check()})),this.errback&&a(e,"error",this.errback)}r=e.id,i=M[r],!L[r]&&i&&!i.enabled&&k.enable(e,this)})),y(this.pluginMaps,t(this,function(e){var t=M[e.id];t&&!t.enabled&&k.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var n=this.events[e];n||(n=this.events[e]=[]),n.push(t)},emit:function(e,t){o(this.events[e],function(e){e(t)}),e==="error"&&delete this.events[e]}},k={config:O,contextName:e,registry:M,defined:B,urlFetched:I,waitCount:0,defQueue:D,Module:C,makeModuleMap:s,configure:function(e){e.baseUrl&&e.baseUrl.charAt(e.baseUrl.length-1)!=="/"&&(e.baseUrl+="/");var t=O.pkgs,n=O.shim,r=O.paths,i=O.map;N(O,e,!0),O.paths=N(r,e.paths,!0),e.map&&(O.map=N(i||{},e.map,!0,!0)),e.shim&&(y(e.shim,function(e,t){E(e)&&(e={deps:e}),e.exports&&!e.exports.__buildReady&&(e.exports=k.makeShimExports(e.exports)),n[t]=e}),O.shim=n),e.packages&&(o(e.packages,function(e){e=typeof e=="string"?{name:e}:e,t[e.name]={name:e.name,location:e.location||e.name,main:(e.main||"main").replace(ka,"").replace(ea,"")}}),O.pkgs=t),y(M,function(e,t){!e.inited&&!e.map.unnormalized&&(e.map=s(t))}),(e.deps||e.callback)&&k.require(e.deps||[],e.callback)},makeShimExports:function(e){var t;return typeof e=="string"?(t=function(){return $(e)},t.exports=e,t):function(){return e.apply(Z,arguments)}},requireDefined:function(e,t){var n=s(e,t,!1,!0).id;return F.call(B,n)},requireSpecified:function(e,t){return e=s(e,t,!1,!0).id,F.call(B,e)||F.call(M,e)},require:function(t,n,r,i){var o;if(typeof t=="string")return x(n)?f(G("requireargs","Invalid require call"),r):j.get?j.get(k,t,n):(t=s(t,n,!1,!0),t=t.id,F.call(B,t)?B[t]:f(G("notloaded",'Module name "'+t+'" has not been loaded yet for context: '+e)));r&&!x(r)&&(i=r,r=void 0),n&&!x(n)&&(i=n,n=void 0);for(l();D.length;){if(o=D.shift(),o[0]===null)return f(G("mismatch","Mismatched anonymous define() module: "+o[o.length-1]));g(o)}return u(s(null,i)).init(t,n,r,{enabled:!0}),m(),k.require},undef:function(e){l();var t=s(e,null,!0),n=M[e];delete B[e],delete I[t.url],delete _[e],n&&(n.events.defined&&(_[e]=n.events),h(e))},enable:function(e){M[e.id]&&u(e).enable()},completeLoad:function(e){var t,n,r=O.shim[e]||{},s=r.exports&&r.exports.exports;for(l();D.length;){n=D.shift();if(n[0]===null){n[0]=e;if(t)break;t=!0}else n[0]===e&&(t=!0);g(n)}n=M[e];if(!t&&!B[e]&&n&&!n.inited){if(O.enforceDefine&&(!s||!$(s))){if(i(e))return;return f(G("nodefine","No define call for "+e,null,[e]))}g([e,r.deps||[],r.exports])}m()},toUrl:function(e,t){var r=e.lastIndexOf("."),i=null;return r!==-1&&(i=e.substring(r,e.length),e=e.substring(0,r)),k.nameToUrl(n(e,t&&t.id,!0),i)},nameToUrl:function(e,t){var n,r,i,s,o,u;if(j.jsExtRegExp.test(e))s=e+(t||"");else{n=O.paths,r=O.pkgs,s=e.split("/");for(o=s.length;o>0;o-=1){if(u=s.slice(0,o).join("/"),i=r[u],u=n[u]){E(u)&&(u=u[0]),s.splice(0,o,u);break}if(i){n=e===i.name?i.location+"/"+i.main:i.location,s.splice(0,o,n);break}}s=s.join("/"),s+=t||(/\?/.test(s)?"":".js"),s=(s.charAt(0)==="/"||s.match(/^[\w\+\.\-]+:/)?"":O.baseUrl)+s}return O.urlArgs?s+((s.indexOf("?")===-1?"?":"&")+O.urlArgs):s},load:function(e,t){j.load(k,e,t)},execCb:function(e,t,n,r){return t.apply(r,n)},onScriptLoad:function(e){if(e.type==="load"||ma.test((e.currentTarget||e.srcElement).readyState))H=null,e=b(e),k.completeLoad(e.id)},onScriptError:function(e){var t=b(e);if(!i(t.id))return f(G("scripterror","Script error",e,[t.id]))}}}},j({}),ba(j),w&&(u=p.head=document.getElementsByTagName("head")[0],B=document.getElementsByTagName("base")[0])&&(u=p.head=B.parentNode),j.onError=function(e){throw e},j.load=function(e,t,n){var r=e&&e.config||{},i;if(w)return i=r.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script"),i.type=r.scriptType||"text/javascript",i.charset="utf-8",i.async=!0,i.setAttribute("data-requirecontext",e.contextName),i.setAttribute("data-requiremodule",t),i.attachEvent&&!(i.attachEvent.toString&&i.attachEvent.toString().indexOf("[native code")<0)&&!S?(K=!0,i.attachEvent("onreadystatechange",e.onScriptLoad)):(i.addEventListener("load",e.onScriptLoad,!1),i.addEventListener("error",e.onScriptError,!1)),i.src=n,I=i,B?u.insertBefore(i,B):u.appendChild(i),I=null,i;fa&&(importScripts(n),e.completeLoad(t))},w&&M(document.getElementsByTagName("script"),function(e){u||(u=e.parentNode);if(s=e.getAttribute("data-main"))return r.baseUrl||(C=s.split("/"),ca=C.pop(),da=C.length?C.join("/")+"/":"./",r.baseUrl=da,s=ca),s=s.replace(ea,""),r.deps=r.deps?r.deps.concat(s):[s],!0}),define=function(e,t,n){var r,i;typeof e!="string"&&(n=t,t=e,e=null),E(t)||(n=t,t=[]),!t.length&&x(n)&&n.length&&(n.toString().replace(ia,"").replace(ja,function(e,n){t.push(n)}),t=(n.length===1?["require"]:["require","exports","module"]).concat(t)),K&&(r=I||ha())&&(e||(e=r.getAttribute("data-requiremodule")),i=z[r.getAttribute("data-requirecontext")]),(i?i.defQueue:P).push([e,t,n])},define.amd={jQuery:!0},j.exec=function(b){return eval(b)},j(r)}})(this),define("requireLib",function(){}),define("js/bonsai_api",[],function(){var e={classes:{Shape:["arcBy","arcTo","lineTo","moveTo"],filter:["Blur","Brightness","ColorMatrix","Contrast","DropShadow","Grayscale","HueRotate","Invert","Opacity","Saturate","Sepia"],Bitmap:["onload"]},methods:{Shape:["arc","circle","ellipse","rect","polygon","star"],filter:["blur","brightness","colorMatrix","contrast","dropShadow","grayscale","hueRotate","invert","saturate","sepia"]},constants:{colors:["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","transparent","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"],easing:["linear","quadIn","quadOut","quadInOut","cubicIn","cubicOut","cubicInOut","quartIn","quartOut","quartInOut","quintIn","quintOut","quintInOut","sineIn","sineOut","sineInOut","expoIn","expoOut","expoInOut","circIn","circOut","circInOut","backIn","backOut","backInOut","elasticIn","elasticOut","elasticInOut","bounceIn","bounceOut","bounceInOut"],attrKeys:["easing","fillColor","fillGradient","filters","fontFamily","fontSize™","lineColor","lineWidth","rotation","scale","textFillColor","textLineColor","x","y"]}};return e}),define("js/value_modifier",["./bonsai_api"],function(e){var t={increase:function(t){return t===""?t:e.methods.Shape.indexOf(t)!=-1?this._getNextInArray(e.methods.Shape,t):e.constants.colors.indexOf(t)!=-1?this._getNextInArray(e.constants.colors,t):e.constants.easing.indexOf(t)!=-1?this._getNextInArray(e.constants.easing,t):e.constants.attrKeys.indexOf(t)!=-1?this._getNextInArray(e.constants.attrKeys,t):e.methods.filter.indexOf(t)!=-1?this._getNextInArray(e.methods.filter,t):e.classes.filter.indexOf(t)!=-1?this._getNextInArray(e.classes.filter,t):isNaN(t)?t:(parseInt(t)+1)%10},decrease:function(t){if(t==="")return t;if(e.methods.Shape.indexOf(t)!=-1)return this._getPreviousInArray(e.methods.Shape,t);if(e.constants.colors.indexOf(t)!=-1)return this._getPreviousInArray(e.constants.colors,t);if(e.constants.easing.indexOf(t)!=-1)return this._getPreviousInArray(e.constants.easing,t);if(e.constants.attrKeys.indexOf(t)!=-1)return this._getPreviousInArray(e.constants.attrKeys,t);if(e.methods.filter.indexOf(t)!=-1)return this._getPreviousInArray(e.methods.filter,t);if(e.classes.filter.indexOf(t)!=-1)return this._getPreviousInArray(e.classes.filter,t);if(isNaN(t))return t;var n=parseInt(t)-1;return n==-1?9:n},_getPreviousInArray:function(e,t){return e[(e.indexOf(t)-1+e.length)%e.length]},_getNextInArray:function(e,t){return e[(e.indexOf(t)+1)%e.length]}};return t}),define("js/auto_completer",["./bonsai_api"],function(e){var t={complete:function(t){var n=this.getDetails(t),r=null;if(n){var i=n.objectName,s=n.methodName;n.isClass?e.classes.hasOwnProperty(i)&&(r=this.completeClass(i,s)):e.methods.hasOwnProperty(i)&&(r=this.completeMethod(i,s))}return r?r:""},completeMethod:function(t,n){var r=e.methods[t];if(!n)return r[0];for(var i=0,s=r.length;i<s;i++)if(r[i].indexOf(n)===0)return r[i].substr(n.length)},completeClass:function(t,n){var r=e.classes[t];if(!n)return r[0];for(var i=0,s=r.length;i<s;i++)if(r[i].indexOf(n)===0)return r[i].substr(n.length)},getDetails:function(e){var t=e.match(/(new\s+)?[a-zA-Z.][a-zA-Z0-9.]+$/);if(t){var n=t[0],r=n.split(".").slice(-1)[0],i=n.substr(0,n.length-r.length-1),s=!!t[1];return s&&(i=i.replace(/^new\s+/,"")),{objectName:i,methodName:r,isClass:s}}return null}};return t}),define("js/editor_extension",["./value_modifier","./auto_completer"],function(e,t){function s(e){this.editor=e}var n=window.ace.require("ace/range"),r=n.Range,i=[{bindKey:{win:"Alt-Up",mac:"Option-Up",sender:"editor"},methodName:"increaseValue"},{bindKey:{win:"Alt-Down",mac:"Option-Down",sender:"editor"},methodName:"decreaseValue"},{bindKey:{win:"Alt-Right",mac:"Option-Right",sender:"editor"},methodName:"autoComplete"}];return s.prototype={connectKeyboardShortcuts:function(){i.forEach(this.connectKeyboardShortcut.bind(this))},connectKeyboardShortcut:function(e){this.editor.commands.addCommand({name:e.methodName,bindKey:e.bindKey,exec:this[e.methodName].bind(this)})},_modifyValue:function(t){var n=this.editor.getCursorPosition(),i=this.editor.getSession(),s=i.getWordRange(n.row,n.column),o=i.getTextRange(s);if(!isNaN(parseFloat(o))){var u=i.getLine(n.row).substr(n.column,1),a=new r(n.row,n.column,n.row,n.column+1);i.replace(a,""+e[t](u))}else i.replace(s,""+e[t](o));this.editor.moveCursorTo(n.row,n.column)},increaseValue:function(){this._modifyValue("increase")},decreaseValue:function(){this._modifyValue("decrease")},autoComplete:function(){var e=this.editor.getCursorPosition(),n=this.editor.getSession(),r=n.getLine(e.row);if(e.column==r.length){var i=t.complete(r.substr(0,e.column));n.insert(e,i)}}},s}),define("js/editor_view",["./editor_extension"],function(e){var t=Backbone.View.extend({initialize:function(t){this.aceEditor=window.ace.edit(t);var n=this.aceEditor.getSession();n.setMode("ace/mode/javascript"),n.setTabSize(2),n.setUseSoftTabs(!0),(new e(this.aceEditor)).connectKeyboardShortcuts();var r=this;this.content="",this.contentChangeTimer=null,n.on("change",function(){clearTimeout(r.contentChangeTimer);var e=r.aceEditor.getSession().getValue();e!==r.content&&(r.content=e,r.contentChangeTimer=setTimeout(function(){r.trigger("update",r.aceEditor.getSession().getValue())},500))})},setEditorContent:function(e){this.aceEditor.getSession().setValue(e)}});return t}),define("js/player_view",["require"],function(e){var t=Backbone.View.extend({initialize:function(e,t,n){var r=e.bonsai,i=e.submovieLoaderUrl;this.canPlay=!1,this.code="",window.editor=this.editor=n,this.baseUrl=e.baseUrl,this.options=_.extend({},this.defaultOptions,t),this.el=document.getElementById(e.elementId),this.el.innerHTML="",this.movie=r.run(this.el,i,this.options),this.movie.once("load",this,function(){this.canPlay=!0,this.code&&this.runCode(this.code)})},defaultOptions:{framerate:60,height:0,width:0},getCharPos:function(){var e=0,t=this.editor.getCursorPosition();for(var n=0;n<t.row;n++)e+=this.editor.session.$rowLengthCache[n];return e+=t.column+t.row,e},highlightEditorRange:function(e,t){var n=this.editor.getSession().getMarkers();for(var r in n)this.editor.getSession().removeMarker(r);var i=0,s=0,o,u,a,f,l;while(i<=t)o=this.editor.session.$rowLengthCache[s],(i>=e||e<i+o)&&typeof u=="undefined"&&(u=s,a=e-i),i+=o+1,i>=t&&typeof f=="undefined"&&(f=s,l=t-(i-(o+1))),s++;console.log(u,a,f,l,e,t),this.editor.getSession().addMarker(new AceRange(u,a,f,l),"ace_selected-word","text"),this.editor.scrollToLine(u,!0,!0)},runCode:function(e){typeof e!="string"&&(e=""),this.code=e;var t=this.movie;this.canPlay&&(t.sendMessage({type:"baseUrl",baseUrl:this.baseUrl}),t.sendMessage({type:"code",code:this.code=e}),this.play(),this.trigger("load"))},pause:function(){this.movie.post("freeze"),this.isPlaying=!1},play:function(){this.movie.post("unfreeze"),this.isPlaying=!0},refresh:function(){this.runCode(this.code)}});return t}),define("js/util",[],function(){return{jsonp:function(e,t){var n=document.createElement("script");n.setAttribute("src",e+"?callback="+t),document.getElementsByTagName("head")[0].appendChild(n)}}}),define("js/url_backend",["./util"],function(e){return Backbone.Model.extend({initialize:function(){var e=this;setTimeout(_.bind(function(){e.trigger("startup",this.load())},this),16)},save:function(e){location.hash=encodeURIComponent(e)},load:function(){var e=location.hash&&location.hash.slice(1);try{return decodeURIComponent(e)}catch(t){return e}}})}),define("js/demo_list_model",[],function(){var e={Showcase:["demos-blobs.js","demos-circles.js","demos-draggable-shapes.js","demos-music.js","demos-pie.js","demos-star.js"],Animation:"animation-simple.js animation-rotation.js animation-easing.js animation-filter.js animation-multiprop.js animation-shared.js animation-clone.js animation-unbound.js animation-events.js animation-keyframes.js animation-color.js animation-gradient.js animation-stars.js animation-stars-2.js animation-circles.js".split(" "),Audio:"audio-simple.js audio-tick-16.js audio-volume.js audio-boom.js audio-button.js".split(" "),"Bitmaps and Sprites":"bitmap.js bitmap-source.js fill-image.js sprite.js data-url.js bitmap-memory-check.js".split(" "),Color:["color.js","linear-gradients.js","radial-gradients.js","color-gradient-knight-rider.js"],"Clipping & Masking":"clip-simple.js clip-staged.js clip-animated.js clip-submovie.js clip-basic.js clip-group.js clip-and-mask.js mask-basic.js mask-group.js mask-animation.js".split(" "),Charts:["charts-bars-3D.js","charts-bubbles.js"],DisplayObjects:["displayobject-delete.js"],Demos:"demo-questionaire.js demo-questionaire-v2.js content-creation.js business-card.js blobs-by-manfred.js svg-lion.js".split(" "),Events:"event-click.js event-drag.js event-bubble.js event-multi-touch.js event-multi-touch2.js".split(" "),Filter:"filter-blur.js filter-list.js filter-multi.js filter-frames.js filter-colorMatrix-shim.js filter-colorMatrix-shim-2.js".split(" "),"Flash stuff":["sprite-properties.js"],Games:["pacman.js"],"Grouping and Layering":["group.js","group-add-and-remove.js","group-nested.js","group-nested-remove.js","layering.js"],Logo:["bikeshed-logo-full.js"],Misc:"stepping_feet.js rotating-square.js bitmap-move-rotation.js raining-rainbows.js 10000-objects.js env.js connect-two-points.js".split(" "),Morph:["animation-morph.js","ugly2polygon-morph.js","ugly2polygon-morph2.js"],"Movies and Submovies":"movie.js movie-frames.js submovie-basic.js submovie-with-asset.js nested-movies-length.js nested-movies-length-stop.js nested-movies-clear.js".split(" "),"Path and Attributes":"shape-square.js shape-simple.js shape-attributes.js shape-interval.js shape-rotate.js shape-arc.js shape-getPointAtLength.js shape-center-of-arc.js shape-fill-rule.js".split(" "),Test:["text.js","text-fonts.js","text-metrics.js","svg-pattern.js"],"Timeline and Frames":["shape-frames.js","shape-frames-seconds.js"],"Transwf translated movies":["tr-line.js","tr-dropshadow.js","execution-order.js"],UI:["ui-button.js"],Video:["video.js","video-remote.js","video-onload.js","video-memory-check.js"]},t=Backbone.Model.extend({initialize:function(e){this.baseUrl=e,this.fetch()},sync:function(t,n,r){switch(t){case"read":n.set("files",e),r.success(e);return}}});return t}),define("js/demo_list_view",[],function(){var e=_.template('    <div class="search">      <input placeholder="Search"/>    </div>  '),t=_.template('    <ul class="files">      <% _.forEach(files, function(catFiles, catName) { %>        <li>          <span class="cat"><%=catName%></span>          <ul>            <% _.forEach(catFiles, function(fileName) { %>              <li><span><%=fileName%></span></li>            <% }); %>          </ul>        </li>      <% }); %>    </ul>  '),n=$(window),r=Backbone.View.extend({className:"demoList",events:{"click .files li li":"openFile","keyup .search input":"search"},initialize:function(){this.hide(),this.currentSearch="",this.model.fetch({success:this.render.bind(this)}),n.resize(this.resizeToFit.bind(this))},render:function(){this.$el.parent()[0]||(this.$el.appendTo(this.options.$container),this.$search=$(e()),this.$search.$input=this.$search.find("input"),this.$search.appendTo(this.$el),this.$downArrow=$("<div class=downArrow>"),this.$upArrow=$("<div class=upArrow>"),this.$fileMenuContainer=$("<div class=filesContainer>"),this.$fileMenuContainer.appendTo(this.$el)),this.$fileMenu&&this.$fileMenu.remove();var n=_.clone(this.model.get("files"));if(this.currentSearch){var r=this.currentSearch;n=_.forEach(n,function(e,t){n[t]=_.filter(e,function(e){return e.indexOf(r)>-1}),n[t].length||delete n[t]})}this.$fileMenu=$(t({files:n})),this.$fileMenuContainer.append(this.$fileMenu)},resizeToFit:function(){this.$el.height(n.height()-parseFloat(this.$el.css("top"))),this.$fileMenuContainer.height(n.height()-this.$fileMenuContainer.offset().top)},openFile:function(e){orbit.trigger("openFile",$(e.currentTarget).text()),this.hide()},show:function(){this.isVisible=!0,this.$el.show(),this.resizeToFit()},hide:function(){this.isVisible=!1,this.$el.hide()},toggle:function(){this.isVisible?this.hide():this.show()},search:function(){this.currentSearch=this.$search.$input.val(),this.render()}});return r}),define("js/sharing_model",[],function(){var e=Backbone.Model.extend({urlRoot:"https://api.github.com/gists",idAttribute:"id",defaults:{description:"Bonsai movie","public":!1,gistUrl:"",files:{"movie.js":{content:""}}}});return e}),define("js/sharing_view",[],function(){var e=_.template('    Copy link: <input type="text" disabled="disabled">  '),t=$(window),n=Backbone.View.extend({className:"sharing popup left",editor:null,dirty:null,events:{"click button":"save"},initialize:function(){this.hide(),this.model.on("change:gistUrl",_.bind(function(e,t){location.hash=encodeURIComponent(t),$("input",this.$el).attr("value",window.location.href)},this)),this.options.$refButton.click(_.bind(function(e){e.stopPropagation(),this.isVisible||this.save(),this.toggle()},this)),this.render()},render:function(){this.$el.parent()[0]||(this.$el.appendTo(this.options.$container),this.$sharingContainer=$(e()),this.$sharingContainer.appendTo(this.$el))},position:function(){var e=this.options.$refButton,t=e.position();this.$el.css({top:t.top+"px",left:t.left+e.outerWidth()+"px",height:e.outerHeight()-1+"px"})},show:function(){this.isVisible=!0,this.options.$refButton.addClass("active"),this.$el.show(),this.position()},hide:function(){this.isVisible=!1,this.options.$refButton.removeClass("active"),this.$el.hide()},toggle:function(){this.isVisible?this.hide():this.show()},loadGist:function(e){this.model.set("id",e),this.model.fetch({success:_.bind(function(e,t){this.options.editor.setValue(t.files["movie.js"].content)},this)})},save:function(){this.model.clear(),this.model.set(this.model.defaults),$("input",this.$el).attr("value","Please wait..."),this.model.save({files:{"movie.js":{content:this.options.editor.getValue()}}},{success:function(e,t){e.set("gistUrl",t.id)}})}});return n}),define("js/cheatsheet/sheet",[],function(){function e(e){return[].slice.call(e)}function t(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var n={hide:function(e){e.style.display="none"},show:function(e){e.style.display="block"},getPreviousNode:function(e,t){t=t.toLowerCase();while(e=e.previousSibling)if(e.nodeName.toLowerCase()===t)return e;return null}},r={options:{showCodeOnly:!1,showH1:!0},init:function(t,n){function s(e){return e.replace(/[&<>]/g,function(e){return i[e]||e})}this.container=t,this.content=n,this.container.innerHTML=this.parseHTMLFromMarkdown(n),this.nodes=e(this.container.children);var r=e(this.container.querySelectorAll("pre")),i={"&":"&amp;","<":"&lt;",">":"&gt;"};r.forEach(function(e){e.dataset.actualInnerHtml=s(e.textContent),$(e).addClass("prettyprint lang-javascript")}),prettyPrint()},parseHTMLFromMarkdown:function(e){return marked.parser(marked.lexer(e))},filter:function(e,t){var r=this.findCodeNodesWithString(e),i=[],s=[],o=this;r.forEach(function(e){i.push(e),o.options.showCodeOnly||i.push(n.getPreviousNode(e,"p")),i.push(n.getPreviousNode(e,"h3")),i.push(n.getPreviousNode(e,"h2")),o.options.showH1&&i.push(n.getPreviousNode(e,"h1")),s.push(e)});var u=!!i.length;t&&!u&&(this.removeMarks(),this.nodes.forEach(n.show));if(u){this.removeMarks();for(var a=0,f=s.length;a<f;a++)o.markInNode(s[a],e);this.nodes.forEach(n.hide),i.forEach(n.show)}prettyPrint()},removeMarks:function(){var t=e(this.container.querySelectorAll("pre"));t.forEach(function(e){e.innerHTML=e.dataset.actualInnerHtml})},findCodeNodesWithString:function(t){var n=this.container.querySelectorAll("pre"),r=this;return e(n).filter(function(e){return r.isInNode(t,e)})},isInNode:function(e,t){return t.dataset.actualInnerHtml.toLowerCase().indexOf(e.toLowerCase())>-1},markSearchString:function(e,n){if(!n)return e;var r=e,i=n.toLowerCase(),s=e.toLowerCase(),o=s.indexOf(i);return o!=-1&&(r=t(e.substr(0,o))+"<mark>"+t(e.substr(o,n.length))+"</mark>",s.substr(o+n.length).indexOf(i)>-1?r+=this.markSearchString(e.substr(o+n.length),n):r+=t(e.substr(o+n.length))),r},markInNode:function(e,t){e.innerHTML=this.markSearchString(e.dataset.actualInnerHtml,t)}};return r}),function(){function c(){var e="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+";return e}function h(e){return e=e.source,function t(n,r){return n?(e=e.replace(n,r.source||r),t):new RegExp(e)}}function p(){}var e={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:p,hr:/^( *[\-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,lheading:/^([^\n]+)\n *(=|-){3,} *\n*/,blockquote:/^( *>[^\n]+(\n[^\n]+)*\n*)+/,list:/^( *)([*+-]|\d+\.) [^\0]+?(?:\n{2,}(?! )(?!\1bullet)\n*|\s*$)/,html:/^ *(?:comment|closed|closing) *(?:\n{2,}|\s*$)/,def:/^ *\[([^\]]+)\]: *([^\s]+)(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,paragraph:/^([^\n]+\n?(?!body))+\n*/,text:/^[^\n]+/};e.list=h(e.list)("bullet",/(?:[*+-](?!(?: *[-*]){2,})|\d+\.)/)(),e.html=h(e.html)("comment",/<!--[^\0]*?-->/)("closed",/<(tag)[^\0]+?<\/\1>/)("closing",/<tag(?!:\/|@)\b(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,c())(),e.paragraph=function(){var t=e.paragraph.source,n=[];return function r(t){return t=e[t]?e[t].source:t,n.push(t.replace(/(^|[^\[])\^/g,"$1")),r}("hr")("heading")("lheading")("blockquote")("<"+c())("def"),new RegExp(t.replace("body",n.join("|")))}(),e.normal={fences:e.fences,paragraph:e.paragraph},e.gfm={fences:/^ *``` *(\w+)? *\n([^\0]+?)\s*``` *(?:\n+|$)/,paragraph:/^/},e.gfm.paragraph=h(e.paragraph)("(?!","(?!"+e.gfm.fences.source.replace(/(^|[^\[])\^/g,"$1")+"|")(),e.lexer=function(t){var n=[];return n.links={},t=t.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    "),e.token(t,n,!0)},e.token=function(t,n,r){var t=t.replace(/^ +$/gm,""),i,s,o,u,a,f,l;while(t){if(o=e.newline.exec(t))t=t.substring(o[0].length),o[0].length>1&&n.push({type:"space"});if(o=e.code.exec(t)){t=t.substring(o[0].length),o=o[0].replace(/^ {4}/gm,""),n.push({type:"code",text:v.pedantic?o:o.replace(/\n+$/,"")});continue}if(o=e.fences.exec(t)){t=t.substring(o[0].length),n.push({type:"code",lang:o[1],text:o[2]});continue}if(o=e.heading.exec(t)){t=t.substring(o[0].length),n.push({type:"heading",depth:o[1].length,text:o[2]});continue}if(o=e.lheading.exec(t)){t=t.substring(o[0].length),n.push({type:"heading",depth:o[2]==="="?1:2,text:o[1]});continue}if(o=e.hr.exec(t)){t=t.substring(o[0].length),n.push({type:"hr"});continue}if(o=e.blockquote.exec(t)){t=t.substring(o[0].length),n.push({type:"blockquote_start"}),o=o[0].replace(/^ *> ?/gm,""),e.token(o,n,r),n.push({type:"blockquote_end"});continue}if(o=e.list.exec(t)){t=t.substring(o[0].length),n.push({type:"list_start",ordered:isFinite(o[2])}),o=o[0].match(/^( *)([*+-]|\d+\.) [^\n]*(?:\n(?!\1(?:[*+-]|\d+\.) )[^\n]*)*/gm),i=!1,l=o.length,f=0;for(;f<l;f++)u=o[f],a=u.length,u=u.replace(/^ *([*+-]|\d+\.) +/,""),~u.indexOf("\n ")&&(a-=u.length,u=v.pedantic?u.replace(/^ {1,4}/gm,""):u.replace(new RegExp("^ {1,"+a+"}","gm"),"")),s=i||/\n\n(?!\s*$)/.test(u),f!==l-1&&(i=u[u.length-1]==="\n",s||(s=i)),n.push({type:s?"loose_item_start":"list_item_start"}),e.token(u,n),n.push({type:"list_item_end"});n.push({type:"list_end"});continue}if(o=e.html.exec(t)){t=t.substring(o[0].length),n.push({type:"html",pre:o[1]==="pre",text:o[0]});continue}if(r&&(o=e.def.exec(t))){t=t.substring(o[0].length),n.links[o[1].toLowerCase()]={href:o[2],title:o[3]};continue}if(r&&(o=e.paragraph.exec(t))){t=t.substring(o[0].length),n.push({type:"paragraph",text:o[0]});continue}if(o=e.text.exec(t)){t=t.substring(o[0].length),n.push({type:"text",text:o[0]});continue}}return n};var t={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,url:p,tag:/^<!--[^\0]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([^\0]+?)__(?!_)|^\*\*([^\0]+?)\*\*(?!\*)/,em:/^\b_((?:__|[^\0])+?)_\b|^\*((?:\*\*|[^\0])+?)\*(?!\*)/,code:/^(`+)([^\0]*?[^`])\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,text:/^[^\0]+?(?=[\\<!\[_*`]| {2,}\n|$)/};t._linkInside=/(?:\[[^\]]*\]|[^\]]|\](?=[^\[]*\]))*/,t._linkHref=/\s*<?([^\s]*?)>?(?:\s+['"]([^\0]*?)['"])?\s*/,t.link=h(t.link)("inside",t._linkInside)("href",t._linkHref)(),t.reflink=h(t.reflink)("inside",t._linkInside)(),t.normal={url:t.url,strong:t.strong,em:t.em,text:t.text},t.pedantic={strong:/^__(?=\S)([^\0]*?\S)__(?!_)|^\*\*(?=\S)([^\0]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([^\0]*?\S)_(?!_)|^\*(?=\S)([^\0]*?\S)\*(?!\*)/},t.gfm={url:/^(https?:\/\/[^\s]+[^.,:;"')\]\s])/,text:/^[^\0]+?(?=[\\<!\[_*`]|https?:\/\/| {2,}\n|$)/},t.lexer=function(e){var i="",s=r.links,o,u,a,c;while(e){if(c=t.escape.exec(e)){e=e.substring(c[0].length),i+=c[1];continue}if(c=t.autolink.exec(e)){e=e.substring(c[0].length),c[2]==="@"?(u=c[1][6]===":"?l(c[1].substring(7)):l(c[1]),a=l("mailto:")+u):(u=f(c[1]),a=u),i+='<a href="'+a+'">'+u+"</a>";continue}if(c=t.url.exec(e)){e=e.substring(c[0].length),u=f(c[1]),a=u,i+='<a href="'+a+'">'+u+"</a>";continue}if(c=t.tag.exec(e)){e=e.substring(c[0].length),i+=v.sanitize?f(c[0]):c[0];continue}if(c=t.link.exec(e)){e=e.substring(c[0].length),i+=n(c,{href:c[2],title:c[3]});continue}if((c=t.reflink.exec(e))||(c=t.nolink.exec(e))){e=e.substring(c[0].length),o=(c[2]||c[1]).replace(/\s+/g," "),o=s[o.toLowerCase()];if(!o||!o.href){i+=c[0][0],e=c[0].substring(1)+e;continue}i+=n(c,o);continue}if(c=t.strong.exec(e)){e=e.substring(c[0].length),i+="<strong>"+t.lexer(c[2]||c[1])+"</strong>";continue}if(c=t.em.exec(e)){e=e.substring(c[0].length),i+="<em>"+t.lexer(c[2]||c[1])+"</em>";continue}if(c=t.code.exec(e)){e=e.substring(c[0].length),i+="<code>"+f(c[2],!0)+"</code>";continue}if(c=t.br.exec(e)){e=e.substring(c[0].length),i+="<br>";continue}if(c=t.text.exec(e)){e=e.substring(c[0].length),i+=f(c[0]);continue}}return i};var n=function(e,n){return e[0][0]!=="!"?'<a href="'+f(n.href)+'"'+(n.title?' title="'+f(n.title)+'"':"")+">"+t.lexer(e[1])+"</a>":'<img src="'+f(n.href)+'" alt="'+f(e[1])+'"'+(n.title?' title="'+f(n.title)+'"':"")+">"},r,i,s=function(){return i=r.pop()},o=function(){switch(i.type){case"space":return"";case"hr":return"<hr>\n";case"heading":return"<h"+i.depth+">"+t.lexer(i.text)+"</h"+i.depth+">\n";case"code":return"<pre><code"+(i.lang?' class="'+i.lang+'"':"")+">"+(i.escaped?i.text:f(i.text,!0))+"</code></pre>\n";case"blockquote_start":var e="";while(s().type!=="blockquote_end")e+=o();return"<blockquote>\n"+e+"</blockquote>\n";case"list_start":var n=i.ordered?"ol":"ul",e="";while(s().type!=="list_end")e+=o();return"<"+n+">\n"+e+"</"+n+">\n";case"list_item_start":var e="";while(s().type!=="list_item_end")e+=i.type==="text"?u():o();return"<li>"+e+"</li>\n";case"loose_item_start":var e="";while(s().type!=="list_item_end")e+=o();return"<li>"+e+"</li>\n";case"html":return v.sanitize?t.lexer(i.text):!i.pre&&!v.pedantic?t.lexer(i.text):i.text;case"paragraph":return"<p>"+t.lexer(i.text)+"</p>\n";case"text":return"<p>"+u()+"</p>\n"}},u=function(){var e=i.text,n;while((n=r[r.length-1])&&n.type==="text")e+="\n"+s().text;return t.lexer(e)},a=function(e){r=e.reverse();var t="";while(s())t+=o();return r=null,i=null,t},f=function(e,t){return e.replace(t?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},l=function(e){var t="",n=e.length,r=0,i;for(;r<n;r++)i=e.charCodeAt(r),Math.random()>.5&&(i="x"+i.toString(16)),t+="&#"+i+";";return t};p.exec=p;var d=function(t,n){return g(n),a(e.lexer(t))},v,m,g=function(n){n||(n=m);if(v===n)return;v=n,v.gfm?(e.fences=e.gfm.fences,e.paragraph=e.gfm.paragraph,t.text=t.gfm.text,t.url=t.gfm.url):(e.fences=e.normal.fences,e.paragraph=e.normal.paragraph,t.text=t.normal.text,t.url=t.normal.url),v.pedantic?(t.em=t.pedantic.em,t.strong=t.pedantic.strong):(t.em=t.normal.em,t.strong=t.normal.strong)};d.options=d.setOptions=function(e){m=e,g(e)},d.options({gfm:!0,pedantic:!1,sanitize:!1}),d.parser=function(e,t){return g(t),a(e)},d.lexer=function(t,n){return g(n),e.lexer(t)},d.parse=d,typeof module!="undefined"?module.exports=d:this.marked=d}.call(this),define("js/marked/marked.js",function(){});var q=null;window.PR_SHOULD_USE_CONTINUATION=!0,function(){function e(e){function t(e){var t=e.charCodeAt(0);if(t!==92)return t;var n=e.charAt(1);return(t=c[n])?t:"0"<=n&&n<="7"?parseInt(e.substring(1),8):n==="u"||n==="x"?parseInt(e.substring(2),16):e.charCodeAt(1)}function n(e){if(e<32)return(e<16?"\\x0":"\\x")+e.toString(16);e=String.fromCharCode(e);if(e==="\\"||e==="-"||e==="["||e==="]")e="\\"+e;return e}function r(e){for(var r=e.substring(1,e.length-1).match(/\\u[\dA-Fa-f]{4}|\\x[\dA-Fa-f]{2}|\\[0-3][0-7]{0,2}|\\[0-7]{1,2}|\\[\S\s]|[^\\]/g),e=[],i=[],s=r[0]==="^",o=s?1:0,u=r.length;o<u;++o){var a=r[o];if(/\\[bdsw]/i.test(a))e.push(a);else{var a=t(a),f;o+2<u&&"-"===r[o+1]?(f=t(r[o+2]),o+=2):f=a,i.push([a,f]),f<65||a>122||(f<65||a>90||i.push([Math.max(65,a)|32,Math.min(f,90)|32]),f<97||a>122||i.push([Math.max(97,a)&-33,Math.min(f,122)&-33]))}}i.sort(function(e,t){return e[0]-t[0]||t[1]-e[1]}),r=[],a=[NaN,NaN];for(o=0;o<i.length;++o)u=i[o],u[0]<=a[1]+1?a[1]=Math.max(a[1],u[1]):r.push(a=u);i=["["],s&&i.push("^"),i.push.apply(i,e);for(o=0;o<r.length;++o)u=r[o],i.push(n(u[0])),u[1]>u[0]&&(u[1]+1>u[0]&&i.push("-"),i.push(n(u[1])));return i.push("]"),i.join("")}function i(e){for(var t=e.source.match(/\[(?:[^\\\]]|\\[\S\s])*]|\\u[\dA-Fa-f]{4}|\\x[\dA-Fa-f]{2}|\\\d+|\\[^\dux]|\(\?[!:=]|[()^]|[^()[\\^]+/g),n=t.length,i=[],u=0,a=0;u<n;++u){var f=t[u];f==="("?++a:"\\"===f.charAt(0)&&(f=+f.substring(1))&&f<=a&&(i[f]=-1)}for(u=1;u<i.length;++u)-1===i[u]&&(i[u]=++s);for(a=u=0;u<n;++u)f=t[u],f==="("?(++a,i[a]===void 0&&(t[u]="(?:")):"\\"===f.charAt(0)&&(f=+f.substring(1))&&f<=a&&(t[u]="\\"+i[a]);for(a=u=0;u<n;++u)"^"===t[u]&&"^"!==t[u+1]&&(t[u]="");if(e.ignoreCase&&o)for(u=0;u<n;++u)f=t[u],e=f.charAt(0),f.length>=2&&e==="["?t[u]=r(f):e!=="\\"&&(t[u]=f.replace(/[A-Za-z]/g,function(e){return e=e.charCodeAt(0),"["+String.fromCharCode(e&-33,e|32)+"]"}));return t.join("")}for(var s=0,o=!1,u=!1,a=0,f=e.length;a<f;++a){var l=e[a];if(l.ignoreCase)u=!0;else if(/[a-z]/i.test(l.source.replace(/\\u[\da-f]{4}|\\x[\da-f]{2}|\\[^UXux]/gi,""))){o=!0,u=!1;break}}for(var c={b:8,t:9,n:10,v:11,f:12,r:13},h=[],a=0,f=e.length;a<f;++a){l=e[a];if(l.global||l.multiline)throw Error(""+l);h.push("(?:"+i(l)+")")}return RegExp(h.join("|"),u?"gi":"g")}function t(e){function t(e){switch(e.nodeType){case 1:if(n.test(e.className))break;for(var u=e.firstChild;u;u=u.nextSibling)t(u);u=e.nodeName;if("BR"===u||"LI"===u)r[o]="\n",s[o<<1]=i++,s[o++<<1|1]=e;break;case 3:case 4:u=e.nodeValue,u.length&&(u=a?u.replace(/\r\n?/g,"\n"):u.replace(/[\t\n\r ]+/g," "),r[o]=u,s[o<<1]=i,i+=u.length,s[o++<<1|1]=e)}}var n=/(?:^|\s)nocode(?:\s|$)/,r=[],i=0,s=[],o=0,u;e.currentStyle?u=e.currentStyle.whiteSpace:window.getComputedStyle&&(u=document.defaultView.getComputedStyle(e,q).getPropertyValue("white-space"));var a=u&&"pre"===u.substring(0,3);return t(e),{a:r.join("").replace(/\n$/,""),c:s}}function n(e,t,n,r){t&&(e={a:t,d:e},n(e),r.push.apply(r,e.e))}function r(t,r){function i(e){for(var t=e.d,f=[t,"pln"],l=0,c=e.a.match(o)||[],h={},p=0,d=c.length;p<d;++p){var v=c[p],m=h[v],g=void 0,y;if(typeof m=="string")y=!1;else{var b=s[v.charAt(0)];if(b)g=v.match(b[1]),m=b[0];else{for(y=0;y<a;++y)if(b=r[y],g=v.match(b[1])){m=b[0];break}g||(m="pln")}(y=m.length>=5&&"lang-"===m.substring(0,5))&&(!g||typeof g[1]!="string")&&(y=!1,m="src"),y||(h[v]=m)}b=l,l+=v.length;if(y){y=g[1];var w=v.indexOf(y),E=w+y.length;g[2]&&(E=v.length-g[2].length,w=E-y.length),m=m.substring(5),n(t+b,v.substring(0,w),i,f),n(t+b+w,y,u(m,y),f),n(t+b+E,v.substring(E),i,f)}else f.push(t+b,m)}e.e=f}var s={},o;(function(){for(var n=t.concat(r),i=[],u={},a=0,f=n.length;a<f;++a){var l=n[a],c=l[3];if(c)for(var h=c.length;--h>=0;)s[c.charAt(h)]=l;l=l[1],c=""+l,u.hasOwnProperty(c)||(i.push(l),u[c]=q)}i.push(/[\S\s]/),o=e(i)})();var a=r.length;return i}function i(e){var t=[],n=[];e.tripleQuotedStrings?t.push(["str",/^(?:'''(?:[^'\\]|\\[\S\s]|''?(?=[^']))*(?:'''|$)|"""(?:[^"\\]|\\[\S\s]|""?(?=[^"]))*(?:"""|$)|'(?:[^'\\]|\\[\S\s])*(?:'|$)|"(?:[^"\\]|\\[\S\s])*(?:"|$))/,q,"'\""]):e.multiLineStrings?t.push(["str",/^(?:'(?:[^'\\]|\\[\S\s])*(?:'|$)|"(?:[^"\\]|\\[\S\s])*(?:"|$)|`(?:[^\\`]|\\[\S\s])*(?:`|$))/,q,"'\"`"]):t.push(["str",/^(?:'(?:[^\n\r'\\]|\\.)*(?:'|$)|"(?:[^\n\r"\\]|\\.)*(?:"|$))/,q,"\"'"]),e.verbatimStrings&&n.push(["str",/^@"(?:[^"]|"")*(?:"|$)/,q]);var i=e.hashComments;return i&&(e.cStyleComments?(i>1?t.push(["com",/^#(?:##(?:[^#]|#(?!##))*(?:###|$)|.*)/,q,"#"]):t.push(["com",/^#(?:(?:define|elif|else|endif|error|ifdef|include|ifndef|line|pragma|undef|warning)\b|[^\n\r]*)/,q,"#"]),n.push(["str",/^<(?:(?:(?:\.\.\/)*|\/?)(?:[\w-]+(?:\/[\w-]+)+)?[\w-]+\.h|[a-z]\w*)>/,q])):t.push(["com",/^#[^\n\r]*/,q,"#"])),e.cStyleComments&&(n.push(["com",/^\/\/[^\n\r]*/,q]),n.push(["com",/^\/\*[\S\s]*?(?:\*\/|$)/,q])),e.regexLiterals&&n.push(["lang-regex",/^(?:^^\.?|[!+-]|!=|!==|#|%|%=|&|&&|&&=|&=|\(|\*|\*=|\+=|,|-=|->|\/|\/=|:|::|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|[?@[^]|\^=|\^\^|\^\^=|{|\||\|=|\|\||\|\|=|~|break|case|continue|delete|do|else|finally|instanceof|return|throw|try|typeof)\s*(\/(?=[^*/])(?:[^/[\\]|\\[\S\s]|\[(?:[^\\\]]|\\[\S\s])*(?:]|$))+\/)/]),(i=e.types)&&n.push(["typ",i]),e=(""+e.keywords).replace(/^ | $/g,""),e.length&&n.push(["kwd",RegExp("^(?:"+e.replace(/[\s,]+/g,"|")+")\\b"),q]),t.push(["pln",/^\s+/,q," \r\n	 "]),n.push(["lit",/^@[$_a-z][\w$@]*/i,q],["typ",/^(?:[@_]?[A-Z]+[a-z][\w$@]*|\w+_t\b)/,q],["pln",/^[$_a-z][\w$@]*/i,q],["lit",/^(?:0x[\da-f]+|(?:\d(?:_\d+)*\d*(?:\.\d*)?|\.\d\+)(?:e[+-]?\d+)?)[a-z]*/i,q,"0123456789"],["pln",/^\\[\S\s]?/,q],["pun",/^.[^\s\w"-$'./@\\`]*/,q]),r(t,n)}function s(e,t){function n(e){switch(e.nodeType){case 1:if(i.test(e.className))break;if("BR"===e.nodeName)r(e),e.parentNode&&e.parentNode.removeChild(e);else for(e=e.firstChild;e;e=e.nextSibling)n(e);break;case 3:case 4:if(a){var t=e.nodeValue,u=t.match(s);if(u){var f=t.substring(0,u.index);e.nodeValue=f,(t=t.substring(u.index+u[0].length))&&e.parentNode.insertBefore(o.createTextNode(t),e.nextSibling),r(e),f||e.parentNode.removeChild(e)}}}}function r(e){function t(e,n){var r=n?e.cloneNode(!1):e,i=e.parentNode;if(i){var i=t(i,1),s=e.nextSibling;i.appendChild(r);for(var o=s;o;o=s)s=o.nextSibling,i.appendChild(o)}return r}for(;!e.nextSibling;)if(e=e.parentNode,!e)return;for(var e=t(e.nextSibling,0),n;(n=e.parentNode)&&n.nodeType===1;)e=n;f.push(e)}var i=/(?:^|\s)nocode(?:\s|$)/,s=/\r\n?|\n/,o=e.ownerDocument,u;e.currentStyle?u=e.currentStyle.whiteSpace:window.getComputedStyle&&(u=o.defaultView.getComputedStyle(e,q).getPropertyValue("white-space"));var a=u&&"pre"===u.substring(0,3);for(u=o.createElement("LI");e.firstChild;)u.appendChild(e.firstChild);for(var f=[u],l=0;l<f.length;++l)n(f[l]);t===(t|0)&&f[0].setAttribute("value",t);var c=o.createElement("OL");c.className="linenums";for(var h=Math.max(0,t-1|0)||0,l=0,p=f.length;l<p;++l)u=f[l],u.className="L"+(l+h)%10,u.firstChild||u.appendChild(o.createTextNode(" ")),c.appendChild(u);e.appendChild(c)}function o(e,t){for(var n=t.length;--n>=0;){var r=t[n];b.hasOwnProperty(r)?window.console&&console.warn("cannot override language handler %s",r):b[r]=e}}function u(e,t){if(!e||!b.hasOwnProperty(e))e=/^\s*</.test(t)?"default-markup":"default-code";return b[e]}function a(e){var n=e.g;try{var r=t(e.h),i=r.a;e.a=i,e.c=r.c,e.d=0,u(n,i)(e);var s=/\bMSIE\b/.test(navigator.userAgent),n=/\n/g,o=e.a,a=o.length,r=0,f=e.c,l=f.length,i=0,c=e.e,h=c.length,e=0;c[h]=a;var p,d;for(d=p=0;d<h;)c[d]!==c[d+2]?(c[p++]=c[d++],c[p++]=c[d++]):d+=2;h=p;for(d=p=0;d<h;){for(var v=c[d],m=c[d+1],g=d+2;g+2<=h&&c[g+1]===m;)g+=2;c[p++]=v,c[p++]=m,d=g}for(c.length=p;i<l;){var y=f[i+2]||a,b=c[e+2]||a,g=Math.min(y,b),w=f[i+1],E;if(w.nodeType!==1&&(E=o.substring(r,g))){s&&(E=E.replace(n,"\r")),w.nodeValue=E;var S=w.ownerDocument,x=S.createElement("SPAN");x.className=c[e+1];var T=w.parentNode;T.replaceChild(x,w),x.appendChild(w),r<y&&(f[i+1]=w=S.createTextNode(o.substring(g,y)),T.insertBefore(w,x.nextSibling))}r=g,r>=y&&(i+=2),r>=b&&(e+=2)}}catch(N){"console"in window&&console.log(N&&N.stack?N.stack:N)}}var f=["break,continue,do,else,for,if,return,while"],l=[[f,"auto,case,char,const,default,double,enum,extern,float,goto,int,long,register,short,signed,sizeof,static,struct,switch,typedef,union,unsigned,void,volatile"],"catch,class,delete,false,import,new,operator,private,protected,public,this,throw,true,try,typeof"],c=[l,"alignof,align_union,asm,axiom,bool,concept,concept_map,const_cast,constexpr,decltype,dynamic_cast,explicit,export,friend,inline,late_check,mutable,namespace,nullptr,reinterpret_cast,static_assert,static_cast,template,typeid,typename,using,virtual,where"],h=[l,"abstract,boolean,byte,extends,final,finally,implements,import,instanceof,null,native,package,strictfp,super,synchronized,throws,transient"],p=[h,"as,base,by,checked,decimal,delegate,descending,dynamic,event,fixed,foreach,from,group,implicit,in,interface,internal,into,is,lock,object,out,override,orderby,params,partial,readonly,ref,sbyte,sealed,stackalloc,string,select,uint,ulong,unchecked,unsafe,ushort,var"],l=[l,"debugger,eval,export,function,get,null,set,undefined,var,with,Infinity,NaN"],d=[f,"and,as,assert,class,def,del,elif,except,exec,finally,from,global,import,in,is,lambda,nonlocal,not,or,pass,print,raise,try,with,yield,False,True,None"],v=[f,"alias,and,begin,case,class,def,defined,elsif,end,ensure,false,in,module,next,nil,not,or,redo,rescue,retry,self,super,then,true,undef,unless,until,when,yield,BEGIN,END"],f=[f,"case,done,elif,esac,eval,fi,function,in,local,set,then,until"],m=/^(DIR|FILE|vector|(de|priority_)?queue|list|stack|(const_)?iterator|(multi)?(set|map)|bitset|u?(int|float)\d*)/,g=/\S/,y=i({keywords:[c,p,l,"caller,delete,die,do,dump,elsif,eval,exit,foreach,for,goto,if,import,last,local,my,next,no,our,print,package,redo,require,sub,undef,unless,until,use,wantarray,while,BEGIN,END"+d,v,f],hashComments:!0,cStyleComments:!0,multiLineStrings:!0,regexLiterals:!0}),b={};o(y,["default-code"]),o(r([],[["pln",/^[^<?]+/],["dec",/^<!\w[^>]*(?:>|$)/],["com",/^<\!--[\S\s]*?(?:--\>|$)/],["lang-",/^<\?([\S\s]+?)(?:\?>|$)/],["lang-",/^<%([\S\s]+?)(?:%>|$)/],["pun",/^(?:<[%?]|[%?]>)/],["lang-",/^<xmp\b[^>]*>([\S\s]+?)<\/xmp\b[^>]*>/i],["lang-js",/^<script\b[^>]*>([\S\s]*?)(<\/script\b[^>]*>)/i],["lang-css",/^<style\b[^>]*>([\S\s]*?)(<\/style\b[^>]*>)/i],["lang-in.tag",/^(<\/?[a-z][^<>]*>)/i]]),["default-markup","htm","html","mxml","xhtml","xml","xsl"]),o(r([["pln",/^\s+/,q," 	\r\n"],["atv",/^(?:"[^"]*"?|'[^']*'?)/,q,"\"'"]],[["tag",/^^<\/?[a-z](?:[\w-.:]*\w)?|\/?>$/i],["atn",/^(?!style[\s=]|on)[a-z](?:[\w:-]*\w)?/i],["lang-uq.val",/^=\s*([^\s"'>]*(?:[^\s"'/>]|\/(?=\s)))/],["pun",/^[/<->]+/],["lang-js",/^on\w+\s*=\s*"([^"]+)"/i],["lang-js",/^on\w+\s*=\s*'([^']+)'/i],["lang-js",/^on\w+\s*=\s*([^\s"'>]+)/i],["lang-css",/^style\s*=\s*"([^"]+)"/i],["lang-css",/^style\s*=\s*'([^']+)'/i],["lang-css",/^style\s*=\s*([^\s"'>]+)/i]]),["in.tag"]),o(r([],[["atv",/^[\S\s]+/]]),["uq.val"]),o(i({keywords:c,hashComments:!0,cStyleComments:!0,types:m}),["c","cc","cpp","cxx","cyc","m"]),o(i({keywords:"null,true,false"}),["json"]),o(i({keywords:p,hashComments:!0,cStyleComments:!0,verbatimStrings:!0,types:m}),["cs"]),o(i({keywords:h,cStyleComments:!0}),["java"]),o(i({keywords:f,hashComments:!0,multiLineStrings:!0}),["bsh","csh","sh"]),o(i({keywords:d,hashComments:!0,multiLineStrings:!0,tripleQuotedStrings:!0}),["cv","py"]),o(i({keywords:"caller,delete,die,do,dump,elsif,eval,exit,foreach,for,goto,if,import,last,local,my,next,no,our,print,package,redo,require,sub,undef,unless,until,use,wantarray,while,BEGIN,END",hashComments:!0,multiLineStrings:!0,regexLiterals:!0}),["perl","pl","pm"]),o(i({keywords:v,hashComments:!0,multiLineStrings:!0,regexLiterals:!0}),["rb"]),o(i({keywords:l,cStyleComments:!0,regexLiterals:!0}),["js"]),o(i({keywords:"all,and,by,catch,class,else,extends,false,finally,for,if,in,is,isnt,loop,new,no,not,null,of,off,on,or,return,super,then,true,try,unless,until,when,while,yes",hashComments:3,cStyleComments:!0,multilineStrings:!0,tripleQuotedStrings:!0,regexLiterals:!0}),["coffee"]),o(r([],[["str",/^[\S\s]+/]]),["regex"]),window.prettyPrintOne=function(e,t,n){var r=document.createElement("PRE");return r.innerHTML=e,n&&s(r,n),a({g:t,i:n,h:r}),r.innerHTML},window.prettyPrint=function(e){function t(){for(var n=window.PR_SHOULD_USE_CONTINUATION?f.now()+250:Infinity;l<r.length&&f.now()<n;l++){var i=r[l],o=i.className;if(o.indexOf("prettyprint")>=0){var o=o.match(h),u,p;if(p=!o){p=i;for(var d=void 0,v=p.firstChild;v;v=v.nextSibling)var m=v.nodeType,d=m===1?d?p:v:m===3?g.test(v.nodeValue)?p:d:d;p=(u=d===p?void 0:d)&&"CODE"===u.tagName}p&&(o=u.className.match(h)),o&&(o=o[1]),p=!1;for(d=i.parentNode;d;d=d.parentNode)if((d.tagName==="pre"||d.tagName==="code"||d.tagName==="xmp")&&d.className&&d.className.indexOf("prettyprint")>=0){p=!0;break}p||((p=(p=i.className.match(/\blinenums\b(?::(\d+))?/))?p[1]&&p[1].length?+p[1]:!0:!1)&&s(i,p),c={g:o,h:i,i:p},a(c))}}l<r.length?setTimeout(t,250):e&&e()}for(var n=[document.getElementsByTagName("pre"),document.getElementsByTagName("code"),document.getElementsByTagName("xmp")],r=[],i=0;i<n.length;++i)for(var o=0,u=n[i].length;o<u;++o)r.push(n[i][o]);var n=q,f=Date;f.now||(f={now:function(){return+(new Date)}});var l=0,c,h=/\blang(?:uage)?-([\w.]+)(?!\S)/;t()},window.PR={createSimpleLexer:r,registerLangHandler:o,sourceDecorator:i,PR_ATTRIB_NAME:"atn",PR_ATTRIB_VALUE:"atv",PR_COMMENT:"com",PR_DECLARATION:"dec",PR_KEYWORD:"kwd",PR_LITERAL:"lit",PR_NOCODE:"nocode",PR_PLAIN:"pln",PR_PUNCTUATION:"pun",PR_SOURCE:"src",PR_STRING:"str",PR_TAG:"tag",PR_TYPE:"typ"}}(),define("js/highlight/prettify.js",function(){}),define("js/orbit",["./editor_view","./player_view","./url_backend","./demo_list_model","./demo_list_view","./sharing_model","./sharing_view","./util","./cheatsheet/sheet","js/marked/marked.js","js/highlight/prettify.js"],function(e,t,n,r,i,s,o,u,a){window.AceRange=ace.require("ace/range").Range;var f=window.Orbit=function(u,f){function b(){y.height($(window).height()-y.offset().top)}var l=new e(u.elementId),c=new t(f,f.bonsaiOptions,l.aceEditor),h=new n,p=new i({model:new r(f.exampleBackendOptions.baseUrl),$container:$("body")}),d=new o({model:new s,editor:l.aceEditor,$refButton:$(".icon-medium.export"),$container:$("body")});this.on("openFile",function(e){e.indexOf("demos-")==0?(f.exampleBackendOptions.baseUrl=f.exampleBackendOptions.baseUrl.replace("examples","demos"),c.baseUrl=c.baseUrl.replace("examples","demos")):(f.exampleBackendOptions.baseUrl=f.exampleBackendOptions.baseUrl.replace("demos","examples"),c.baseUrl=c.baseUrl.replace("demos","examples")),console.log("Get",f.exampleBackendOptions.baseUrl+"/"+e),$.ajax({url:f.exampleBackendOptions.baseUrl+"/"+e,dataType:"text"}).success(function(e){l.setEditorContent(e)})}),l.on("update",function(e){c.runCode(e),h.save(e)}),h.on("startup",function(e){/^.*\.js$/i.test(e)?orbit.trigger("openFile",e):e.length>0?(l.setEditorContent(e),c.runCode(e)):l.setEditorContent('new Rect(100, 100, 100, 100).fill("red").addTo(stage);')});var v=document.getElementById("play-pause");c.on("load",function(){v.checked=!0}),v.onchange=function(){c[this.checked?"play":"pause"]()},$.get(u.cheatSheetUrl,function(e){a.init(document.getElementById("cheatsheet-content"),e),a.options.showH1=!0});var m="",g={};setInterval(function(){if(l&&$(w).css("display")=="block"){var e=l.aceEditor.getCursorPosition(),t=l.aceEditor.getSession(),n=t.getWordRange(e.row,e.column),r=t.getTextRange(n),i=r==parseInt(r);/\w*/.test(r)&&m!=r&&!i&&a.filter(m=r),g=e}},500);var y=$("#container");$(window).resize(b),b(),$(document.body).on("touchmove",function(e){e.target==document.body&&e.preventDefault()});var w=$("#cheatsheet");$(".icon-medium.new").click(function(){l.setEditorContent("")}),$(".icon-medium.refresh").click(function(){c.refresh()}),$(".icon-medium.files").click(function(e){p.toggle(),e.stopPropagation()});var E=$(".icon-medium.keyboard");E.click(function(){E.toggleClass("active"),w.toggle()}),$(document).click(function(e){p.isVisible&&!$(e.target).closest(p.$el)[0]&&p.hide(),d.isVisible&&!$(e.target).closest(d.$el)[0]&&d.hide()})};return f.prototype=Object.create(Backbone.Events),f})